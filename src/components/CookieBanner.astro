---
const isPL = Astro.url.pathname === "/pl" || Astro.url.pathname.startsWith("/pl/");
const privacyHref = isPL ? "/pl/privacy" : "/privacy";
const cookiesHref = isPL ? "/pl/cookies" : "/cookies";
---

<div
  id="cookie-banner"
  class="fixed bottom-4 left-4 right-4 mx-auto max-w-3xl hidden"
>
  <div class="rounded-2xl border border-zinc-200 bg-white p-4 shadow-sm dark:border-zinc-800 dark:bg-zinc-900">
    <p class="text-sm text-zinc-700 dark:text-zinc-300">
      {isPL
        ? "Używam niezbędnych plików cookies do działania strony. Opcjonalnie mogę używać analityki. Możesz zaakceptować lub odrzucić."
        : "I use necessary cookies to make this site work. Optionally, I may use analytics. You can accept or reject."}
    </p>

    <p class="mt-2 text-xs text-zinc-500 dark:text-zinc-400">
      <a class="hover:underline" href={privacyHref}>{isPL ? "Polityka prywatności" : "Privacy Policy"}</a>
      <span class="px-2">·</span>
      <a class="hover:underline" href={cookiesHref}>{isPL ? "Cookies" : "Cookies"}</a>
    </p>

    <div class="mt-4 flex gap-2 flex-wrap">
      <button
        id="cookie-accept"
        class="rounded-lg bg-zinc-900 px-4 py-2 text-sm text-white hover:opacity-90 dark:bg-white dark:text-zinc-900"
      >
        {isPL ? "Akceptuję" : "Accept"}
      </button>
      <button
        id="cookie-reject"
        class="rounded-lg border border-zinc-200 px-4 py-2 text-sm hover:bg-zinc-50 dark:border-zinc-800 dark:hover:bg-zinc-800/50"
      >
        {isPL ? "Odrzucam" : "Reject"}
      </button>
    </div>
  </div>
</div>

<script>
  const key = "cookie-consent";
  const banner = document.getElementById("cookie-banner");
  const accept = document.getElementById("cookie-accept");
  const reject = document.getElementById("cookie-reject");

  const existing = localStorage.getItem(key);
  if (!existing) banner?.classList.remove("hidden");

  accept?.addEventListener("click", () => {
    localStorage.setItem(key, "accepted");
    banner?.classList.add("hidden");
  });

  reject?.addEventListener("click", () => {
    localStorage.setItem(key, "rejected");
    banner?.classList.add("hidden");
  });
</script>
